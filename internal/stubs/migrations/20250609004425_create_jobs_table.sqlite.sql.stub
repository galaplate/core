-- migrate:up
CREATE TABLE jobs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    type VARCHAR(255) NOT NULL,
    payload TEXT,
    state VARCHAR(16) NOT NULL CHECK (state IN ('pending', 'started', 'finished', 'failed')),
    error_msg TEXT,
    attempts INTEGER,
    available_at DATETIME,
    created_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    started_at DATETIME,
    finished_at DATETIME
);

-- migrate:down
DROP TABLE IF EXISTS jobs;